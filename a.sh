BOPT=-D
grep -q Linux /proc/version && BOPT=-d
# Files tsens-orig/tsens.js and tsens-new/tsens.js differ
base64 $BOPT <<EOOOFDIRDIFF >tsens.js
bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzdGFydHVwKG9wdGlvbnMsIGltcG9ydHMsIHJlZ2lz
dGVyKSB7CiAgICB2YXIgY29uZmlnID0gcmVxdWlyZShvcHRpb25zLmNvbmZpZyk7CiAgICB2YXIg
bGF0ZXIgPSByZXF1aXJlKCdsYXRlcicpOwogICAgdmFyIGFzeW5jID0gcmVxdWlyZSgnYXN5bmMn
KTsKICAgIHZhciBRdWV1ZSA9IHJlcXVpcmUoJ2J1bGwnKTsKICAgIHZhciBxdWV1ZSA9IG5ldyBR
dWV1ZSgidHNlbnMiLCA2Mzc5LCAnMTI3LjAuMC4xJywge30sIHRydWUpOwoKICAgIGZ1bmN0aW9u
IG15Q2xlYW4oKSB7CiAgICAgICAgcXVldWUuY2xlYW4oMTAwMDAsICdjb21wbGV0ZWQnKTsKICAg
ICAgICBxdWV1ZS5jbGVhbigxMDAwMCwgJ2ZhaWxlZCcpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNj
aGVkdWxlSm9icygpIHsKICAgICAgICB2YXIgZW5hYmxlZCA9IFtdOwogICAgICAgIGFzeW5jLmVh
Y2hTZXJpZXMoY29uZmlnLCBmdW5jdGlvbiBpdGVyYXRlZShpdGVtLCBjYWxsYmFjaykgewogICAg
ICAgIHZhciBqb2IgPSBpdGVtOwogICAgICAgIGlmIChqb2IuZW5hYmxlZCkgewogICAgICAgICAg
ICBhc3luYy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHNldHVwSm9i
KGpvYiwgZnVuY3Rpb24oZXJyLCBqb2IpIHsKICAgICAgICAgICAgICAgIGlmIChlcnIpIHsgCiAg
ICAgICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyKTsKICAgICAgICAgICAgICAgICAgICBjb25z
b2xlLmxvZygic2V0dXAgZm9yIGpvYiBmYWlsZWQgIiArIGpvYi5wbHVnaW4pOwogICAgICAgICAg
ICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygic2V0dXAgZm9y
IGpvYiAiICsgam9iLnBsdWdpbik7CiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZC5wdXNoKGpv
Yik7CiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobnVsbCwgam9iKTsKICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlCiAg
ICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGpvYik7CiAgICAgICAgfSwgZnVuY3Rpb24gZG9uZSgp
IHsKICAgICAgICAgICAgY29uc29sZS5sb2coInJlc3VtaW5nIHByaW9yaXR5IHF1ZXVlIik7CiAg
ICAgICAgICAgIHF1ZXVlLnJlc3VtZSgpLnRoZW4oZnVuY3Rpb24oam9iKSB7CiAgICAgICAgICAg
ICAgICB3aGlsZSAoZW5hYmxlZC5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgam9i
ID0gZW5hYmxlZC5zaGlmdCgpOwogICAgICAgICAgICAgICAgICAgIGlmICgham9iLnNjaGVkdWxl
KQogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAg
YWRkSm9iKGpvYiwgZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChl
cnIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiYWRkaW5nIGpvYiBm
YWlsZWQgIiArIGpvYi5wbHVnaW4pOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiYWRkaW5nIGpvYiBmb3IgIiArIGpv
Yi5wbHVnaW4pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAg
ICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBkaXNwYXRjaEpvYihq
b2IsIG9wdGlvbnMpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAg
ICBjb25zb2xlLmxvZygiZGlzcGF0Y2hpbmc6ICIgKyBqb2IucGx1Z2luKTsKICAgICAgICBxdWV1
ZS5hZGQoam9iLCBvcHRpb25zKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXR1cEpvYihqb2IsIGNh
bGxiYWNrKSB7CiAgICAgICAgdmFyIHBsdWdpbiA9IGltcG9ydHMuZ2V0UGx1Z2luKGpvYi5wbHVn
aW4pOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgdHJ5IHsK
ICAgICAgICAgICAgcGx1Z2luLnNldHVwKGpvYiwgY2FsbGJhY2spOwogICAgICAgIH0gY2F0Y2gg
KGVycm9yKSB7CiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnJvcik7CiAgICAgICAgfTsK
ICAgIH0KCiAgICBmdW5jdGlvbiBlbmRKb2Ioam9iKSB7CiAgICAgICAgaWYgKGpvYi50eXBlICE9
ICJxdWV1ZSIpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB2YXIgc2NoZWR1bGVTcGxpdDsK
CiAgICAgICAgdmFyIHNwbGl0Q3JvbiA9IGpvYi5zY2hlZHVsZS5zcGxpdCgnICcpOwoKICAgICAg
ICB2YXIgbWludXRlU3BsaXQgPSBzcGxpdENyb25bMF0uc3BsaXQoJy0nKTsKICAgICAgICBpZiAo
bWludXRlU3BsaXRbMV0pIHsKICAgICAgICAgICAgc3BsaXRDcm9uWzBdID0gbWludXRlU3BsaXRb
MV0KICAgICAgICAgICAgc2NoZWR1bGVTcGxpdCA9IDE7CiAgICAgICAgfSBlbHNlCiAgICAgICAg
ICAgIHNwbGl0Q3JvblswXSA9IDA7CgogICAgICAgIHZhciBob3VyU3BsaXQgPSBzcGxpdENyb25b
MV0uc3BsaXQoJy0nKTsKICAgICAgICBpZiAoaG91clNwbGl0WzFdKSB7CiAgICAgICAgICAgIHNw
bGl0Q3JvblsxXSA9IHBhcnNlSW50KGhvdXJTcGxpdFsxXSkgKyAxOwogICAgICAgICAgICBpZiAo
c3BsaXRDcm9uWzFdID09IDI0KQogICAgICAgICAgICAgICAgc3BsaXRDcm9uWzFdID0gMDsKICAg
ICAgICAgICAgc2NoZWR1bGVTcGxpdCA9IDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoIXNjaGVk
dWxlU3BsaXQpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgdmFyIGVuZENyb24gPSBzcGxp
dENyb24uam9pbignICcpOwoKICAgICAgICBjb25zb2xlLmxvZygiU2NoZWR1bGluZyBqb2IgZW5k
IG9mICIgKyBlbmRDcm9uKTsKCiAgICAgICAgdmFyIGVuZENyb25TY2hlZCA9IGxhdGVyLnBhcnNl
LmNyb24oZW5kQ3Jvbik7CgogICAgICAgIGxhdGVyLnNldEludGVydmFsKGZ1bmN0aW9uKCkgewog
ICAgICAgICAgICAgICAgZGlzcGF0Y2hKb2IoewogICAgICAgICAgICAgICAgICAgIHBsdWdpbjog
am9iLnBsdWdpbiwKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBoYWx0
OiAnMScKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVuZENy
b25TY2hlZCk7CiAgICB9CgogICAgZnVuY3Rpb24gYWRkSm9iKGpvYikgewogICAgICAgIGRpc3Bh
dGNoSm9iKHsKICAgICAgICAgICAgICAgIHBsdWdpbjogam9iLnBsdWdpbiwKICAgICAgICAgICB9
LAogICAgICAgICAgIGpvYi5vcHRpb25zKQoKICAgICAgICBpZiAoIWpvYi5zY2hlZHVsZSkKICAg
ICAgICAgICByZXR1cm47ICAgICAgICAKICAgICAgIAogICAgICAgIHZhciBjcm9uU2NoZWQgPSBs
YXRlci5wYXJzZS5jcm9uKGpvYi5zY2hlZHVsZSk7CgogICAgICAgIHZhciB0aW1lciA9IGxhdGVy
LnNldEludGVydmFsKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgZGlzcGF0Y2hKb2Ioewog
ICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW46IGpvYi5wbHVnaW4sCiAgICAgICAgICAgICAg
ICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBqb2Iub3B0aW9ucykKICAgICAgICAgICAgfSwK
ICAgICAgICAgICAgY3JvblNjaGVkCiAgICAgICAgKTsKCiAgICAgICAgZW5kSm9iKGpvYik7CiAg
ICB9CgogICAgcXVldWUub24oJ3JlYWR5JywgZnVuY3Rpb24oKSB7CiAgICAgICAgY29uc29sZS5s
b2coInByaW9yaXR5IHF1ZXVlIHJlYWR5IG5vdyBwYXVzZSIpOwogICAgICAgIHF1ZXVlLnBhdXNl
KCkudGhlbihmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmVnaXN0ZXIobnVsbCwgewogICAgICAg
ICAgICAgICAgdHNlbnM6IHsKICAgICAgICAgICAgICAgICAgICBzY2hlZHVsZUpvYnM6IGZ1bmN0
aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlSm9icygpOwogICAgICAgICAg
ICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb25EZXN0cnVjdDogZnVuY3Rpb24oY2Fs
bGJhY2spIHt9LAogICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAg
cXVldWUucHJvY2VzcyhmdW5jdGlvbihqb2IsIGRvbmUpIHsKICAgICAgICAgICAgICAgIHZhciBw
bHVnaW4gPSBpbXBvcnRzLmdldFBsdWdpbihqb2IuZGF0YS5wbHVnaW4pOwogICAgICAgICAgICAg
ICAgY29uc29sZS5sb2coIlBsdWdpbiBTdWJtaXQgIiArIGpvYi5kYXRhLnBsdWdpbik7CiAgICAg
ICAgICAgICAgICBwbHVnaW4ucnVuKGpvYi5vcHRzLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAg
ICAgICAgICBjb25zb2xlLmxvZygiRklOSVNIRUQiKTsKICAgICAgICAgICAgICAgICAgICBkb25l
KG51bGwsIHRydWUpOwogICAgICAgICAgICAgICAgfSk7ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIH0pOwog
ICAgcXVldWUub24oJ2NvbXBsZXRlZCcsIGZ1bmN0aW9uKCkgewogICAgICAgIG15Q2xlYW4oKTsK
ICAgIH0pOwogICAgcXVldWUub24oJ2ZhaWxlZCcsIGZ1bmN0aW9uKCkgewogICAgICAgIG15Q2xl
YW4oKTsKICAgIH0pOwp9Owo=
EOOOFDIRDIFF
